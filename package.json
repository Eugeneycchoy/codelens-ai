{
  "name": "codelens-ai",
  "displayName": "CodeLens AI",
  "version": "0.0.1",
  "description": "AI-powered code explanations on hover. Hover over any line or code block to see what it does, why it exists, and how it connects to surrounding code.",
  "publisher": "placeholder-publisher",
  "engines": {
    "vscode": "^1.85.0"
  },
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./dist/extension.js",
  "categories": [
    "Other"
  ],
  "scripts": {
    "build": "node esbuild.config.js",
    "watch": "node esbuild.config.js --watch",
    "test": "vitest run",
    "test:watch": "vitest",
    "package": "vsce package",
    "validate": "node validate.js"
  },
  "dependencies": {
    "@anthropic-ai/sdk": "^0.30.0",
    "ai": "^3.0.0",
    "openai": "^4.0.0"
  },
  "devDependencies": {
    "@types/node": "^20.10.0",
    "@types/vscode": "^1.85.0",
    "@vscode/vsce": "^3.0.0",
    "esbuild": "^0.19.0",
    "typescript": "^5.3.0",
    "vitest": "^4.0.18"
  },
  "contributes": {
    "commands": [
      {
        "command": "codelens-ai.explainCode",
        "title": "CodeLens AI: Explain Selected Code"
      },
      {
        "command": "codelens-ai.retryHoverExplanation",
        "title": "CodeLens AI: Retry Hover Explanation"
      },
      {
        "command": "codelens-ai.statusBarClick",
        "title": "CodeLens AI: Show Menu"
      },
      {
        "command": "codelens-ai.prototype.selectMode",
        "title": "CodeLens AI: Select UI Mode"
      },
      {
        "command": "codelens-ai.quickPeek",
        "title": "CodeLens AI: Quick Peek Explanation"
      },
      {
        "command": "codelens-ai.inlinePeek",
        "title": "CodeLens AI: Inline Peek Explanation"
      },
      {
        "command": "codelens-ai.explainInPanel",
        "title": "CodeLens AI: Explain in Side Panel"
      },
      {
        "command": "codelens-ai.explainFloating",
        "title": "CodeLens AI: Explain in Floating Panel"
      },
      {
        "command": "codelens-ai.prototype.toggleCodeLens",
        "title": "CodeLens AI: Toggle CodeLens Annotations"
      },
      {
        "command": "codelens-ai.experiment.menu",
        "title": "CodeLens AI: Hover Experiments Menu"
      },
      {
        "command": "codelens-ai.experiment.stop",
        "title": "CodeLens AI: Stop Hover Experiment"
      },
      {
        "command": "codelens-ai.experiment.status",
        "title": "CodeLens AI: Show Experiment Status"
      },
      {
        "command": "codelens-ai.experiment.run.null-returning",
        "title": "CodeLens AI: Run Experiment - Null Returning"
      },
      {
        "command": "codelens-ai.experiment.run.always-return",
        "title": "CodeLens AI: Run Experiment - Always Return Hover"
      },
      {
        "command": "codelens-ai.experiment.run.conditional",
        "title": "CodeLens AI: Run Experiment - Conditional Hover"
      },
      {
        "command": "codelens-ai.experiment.run.multi-provider",
        "title": "CodeLens AI: Run Experiment - Multi Provider"
      },
      {
        "command": "codelens-ai.experiment.run.registration-order-high-first",
        "title": "CodeLens AI: Run Experiment - Registration Order (High First)"
      },
      {
        "command": "codelens-ai.experiment.run.registration-order-high-last",
        "title": "CodeLens AI: Run Experiment - Registration Order (High Last)"
      },
      {
        "command": "codelens-ai.experiment.run.registration-order-first-second-high",
        "title": "CodeLens AI: Run Experiment - Registration Order (Mixed)"
      },
      {
        "command": "codelens-ai.experiment.run.async",
        "title": "CodeLens AI: Run Experiment - Async Provider"
      },
      {
        "command": "codelens-ai.experiment.run.undefined",
        "title": "CodeLens AI: Run Experiment - Undefined Return"
      },
      {
        "command": "codelens-ai.experiment.run.empty-content",
        "title": "CodeLens AI: Run Experiment - Empty Content"
      }
    ],
    "views": {
      "explorer": [
        {
          "type": "webview",
          "id": "codelens-ai.explanationPanel",
          "name": "CodeLens AI",
          "when": "codelensAI.prototype.sidePanelEnabled"
        }
      ]
    },
    "keybindings": [
      {
        "command": "codelens-ai.quickPeek",
        "key": "ctrl+shift+e",
        "mac": "cmd+shift+e",
        "when": "editorTextFocus"
      },
      {
        "command": "codelens-ai.explainInPanel",
        "key": "ctrl+shift+alt+e",
        "mac": "cmd+shift+alt+e",
        "when": "editorTextFocus"
      }
    ],
    "configuration": {
      "title": "CodeLens AI",
      "properties": {
        "codelensAI.provider": {
          "type": "string",
          "enum": [
            "openai",
            "anthropic",
            "ollama"
          ],
          "description": "AI provider to use for code explanations."
        },
        "codelensAI.apiKey": {
          "type": "string",
          "description": "API key for the selected provider (not used for Ollama)."
        },
        "codelensAI.apiBase": {
          "type": "string",
          "default": "",
          "pattern": "^https?://[^\\s]+",
          "patternErrorMessage": "Must start with http:// or https://",
          "description": "Base URL for the API (e.g. https://api.zhihuiai.top/v1). Leave empty to use the provider's default endpoint."
        },
        "codelensAI.ollamaEndpoint": {
          "type": "string",
          "default": "http://localhost:11434",
          "description": "Ollama API endpoint URL."
        },
        "codelensAI.model": {
          "type": "string",
          "default": "gpt-4o-mini",
          "description": "Model name to use for explanations."
        },
        "codelensAI.highlightColor": {
          "type": "string",
          "default": "",
          "description": "Background color for the hover-highlighted code block (e.g. \"rgba(0, 128, 128, 0.2)\"). Leave empty to use theme-aware defaults (dark: teal 15%, light: teal 25%, high-contrast: white 10%)."
        },
        "codelensAI.enableExperiments": {
          "type": "boolean",
          "default": false,
          "description": "Enable experimental hover provider testing module. Only enable for development/testing purposes."
        },
        "codelensAI.prototype.mode": {
          "type": "string",
          "enum": [
            "hover",
            "codelens",
            "peek",
            "quickpeek",
            "inlinepeek",
            "sidepanel",
            "floatingpanel",
            "hybrid"
          ],
          "default": "hybrid",
          "enumDescriptions": [
            "Original hover tooltips (merged with VS Code hovers)",
            "Inline clickable annotations above code constructs",
            "Peek definition-style overlay using virtual documents",
            "Fast modal explanation using Quick Pick",
            "Inline decoration below the hovered line",
            "Persistent sidebar webview with history",
            "Floating webview panel beside the editor",
            "Combination of CodeLens + Side Panel"
          ],
          "description": "UI mode for displaying AI explanations. Each mode offers different trade-offs."
        },
        "codelensAI.prototype.sidePanelEnabled": {
          "type": "boolean",
          "default": true,
          "description": "Show the CodeLens AI panel in the Explorer sidebar."
        },
        "codelensAI.prototype.enablePrototypes": {
          "type": "boolean",
          "default": true,
          "description": "Enable UI prototype alternatives (CodeLens, Peek View, Side Panel). Set to false to disable alternative UI modes."
        }
      }
    }
  }
}
